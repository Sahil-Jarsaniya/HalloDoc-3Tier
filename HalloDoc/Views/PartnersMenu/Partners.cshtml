@model PartnersViewModel;
@{
    ViewData["Title"] = "Admin Profile";
    Layout = "_adminLayout";
}
<div class="container d-flex justify-content-between mt-4" style="max-width:1500px">
    <h4>
        Vendor(s)
    </h4>
</div>
<div class="container d-sm-flex justify-content-between mt-4" style="max-width:1500px">
    <form method="post" id="DashboradForm">
        <div class="d-md-flex mb-3 mb-lg-0">

            <div class="d-flex normal-input rounded align-items-center ps-2 me-md-2 mb-2 mb-md-0">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 50 50">
                    <path d="M 21 3 C 11.654545 3 4 10.654545 4 20 C 4 29.345455 11.654545 37 21 37 C 24.701287 37 28.127393 35.786719 30.927734 33.755859 L 44.085938 46.914062 L 46.914062 44.085938 L 33.875 31.046875 C 36.43682 28.068316 38 24.210207 38 20 C 38 10.654545 30.345455 3 21 3 z M 21 5 C 29.254545 5 36 11.745455 36 20 C 36 28.254545 29.254545 35 21 35 C 12.745455 35 6 28.254545 6 20 C 6 11.745455 12.745455 5 21 5 z">
                    </path>
                </svg>
                <input asp-for="Name" type="search"  id="searchbyName" class="form-control border border-0" placeholder="Search Vendors">
            </div>

            <div class="d-flex normal-input rounded align-items-center ms-lg-2 ps-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 50 50">
                    <path d="M 21 3 C 11.654545 3 4 10.654545 4 20 C 4 29.345455 11.654545 37 21 37 C 24.701287 37 28.127393 35.786719 30.927734 33.755859 L 44.085938 46.914062 L 46.914062 44.085938 L 33.875 31.046875 C 36.43682 28.068316 38 24.210207 38 20 C 38 10.654545 30.345455 3 21 3 z M 21 5 C 29.254545 5 36 11.745455 36 20 C 36 28.254545 29.254545 35 21 35 C 12.745455 35 6 28.254545 6 20 C 6 11.745455 12.745455 5 21 5 z">
                    </path>
                </svg>
                <select class="form-select border-0" id="RegionSearch" name="RegionFilter" aria-label="Default select example" asp-for="RegionId">
                    <option value="null">All Regions</option>
                    @foreach(var item in Model.regions)
                    {
                        <option value="@item.Regionid">@item.Name</option>
                    }
                </select>
            </div>
        </div>
    </form>
    <a href="@Url.Action("AddVendors")" class="btn btn-outline-primary m-2 mt-sm-0 float-sm-end ">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-plus" viewBox="0 0 16 16">
            <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4" />
        </svg>
        Add Business
    </a>
</div>
<div class="container mt-4" style="max-width:1500px" id="VendorTable">
   
</div>

@section AdminScript {
    <script>
        $(document).ready(function () {
            $("#VendorTable").load('/PartnersMenu/VendorTable' , function (response, status, xhr) {
                if (status != "success") {
                    console.log("Error loading partial view" + xhr.status + " " + xhr.statusText);
                }
            });
        });
        $("#RegionSearch").change(function () {
            var RegionId = $(this).val();
            var Name = $("#searchbyName").val();
            console.log(RegionId);
            console.log(Name);
            $.ajax({
                url: '/PartnersMenu/VendorTable',
                type: 'POST',
                data: { name: Name, regionId: RegionId },
                success: function (result) {
                    $('#VendorTable').html(result);
                },
                error: function (error) {
                    console.log(error);
                    alert('error fetching details')
                },
            })
        });

        //search box
        $("#searchbyName").keyup(function (e) {
            var RegionId = $("#RegionSearch").val();
            var Name = $("#searchbyName").val();
            $.ajax({
                url: '/PartnersMenu/VendorTable',
                type: 'POST',
                data: { name: Name, regionId: RegionId },
                success: function (result) {
                    $('#VendorTable').html(result);
                },
                error: function (error) {
                    console.log(error);
                    alert('error fetching details')
                },
            })
        });
    </script>
}